<html>
	<head>
	<title>network-graph</title>
	<script src="/socket.io/socket.io.js" type='text/javascript'></script>
	<script src="/jquery.js" type="text/javascript"></script>
	<script src="/jquery.ui.js" type="text/javascript"></script>
	<script type='text/javascript'>
		function showMessage( msg ){
			$("#message").html( msg + "<br>\n" );
		}

		function debug( msg ){
			$("#debug").append( msg + "<br>\n" );
		}

		$(document).ready( function( ){

			showMessage( "Starting up.." );
			var socket	= new io.Socket( null, { port: 8080, rememberTransport: false } );

			showMessage( "Connecting to socket.. " );
			socket.connect( );

			socket.on( 'connect', function( ){
				showMessage( "Connected to socket.." );
			} );

			socket.on( 'message', function( obj ){
				if( typeof obj.request != 'undefined' ){
					parseRequestResponse( obj );
				}else{
					debug( "Got unknown message of '" + obj.toString() + "'" );
				}
			} );

			socket.on( 'disconnect', function( ){
				showMessage( "Disconnected from socket.." );
			} );

			function parseRequestResponse( objToParse ){
				debug( "Parsing request of '" + objToParse.request + "'" );
				if( typeof objToParse.response == 'undefined' ){
					if( objToParse.request == 'filter' ){
						showFilterDiag( );
					}else{
						debug( "Unknown request made for '" + objToParse.request + "'" );
					}
				}else{
					// Response
				}
			}

			function showFilterDiag( ){
				$("#filter-diag").dialog({
					autoOpen: false,
					height: 150,
					width: 400,
					modal: true,
					buttons: {
						"Set filter": function( ){
							socket.send( [ { request: 'filter', response: $("#filter").val() } ] );
						}
					}
				} );

				$("#filter-diag").dialog( "open" );
			}
		});
	</script>
	<style type='text/css'>
		body {
			font-size: 120%;
		}
		label, input {
			display: block;
		}
		input.text {
			margin-bottom: 12px; width: 95%; padding .4em;	
		}
		fieldset {
			padding: 0;
			border: 0;
			margin-top 25px;
		}
		#filter-diag {
			border: 1px solid black;
			background-color: #eee;
			margin: 25px;
		}
	</style>
<body>
	<h1>network-graph</h1>
	<div id='message'></div>
	<div id='filter-diag' title='Filter Dialog'>
		<form>
			<fieldset>
				<label for="filter">Filter</label>
				<input type="text" name="filter" id="filter" class="text ui-widget-common ui-corner-all" />
			</fieldset>
		</form>
	</div>
	</div>
	<div id='debug'></div>
</body>
</html>
