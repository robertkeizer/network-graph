<html>
    <head>
        <title>network-graph</title>
        <script src="/socket.io/socket.io.js" type='text/javascript'></script>
        <script src="/jquery.js" type="text/javascript"></script>
    </head>
<body>
    <script type='text/javascript'>
        $(document).ready( function( ){
	    var counterArray = new Array();
            function message( msg ){
		if( counterArray[msg.toString()] > 0 ){
			counterArray[msg.toString()]++;
		}else{
			counterArray[msg.toString()] = 1;
		};

		$("#messages").append( msg + "(" + counterArray[msg.toString()] + ")<br />\n" );
            };

            function esc( msg ){
                return msg.replace(/</g, '&lt;').replace(/>/g, '&gt;' );
            };
            
            var socket = new io.Socket( null, { port: 8080, rememberTransport: false } );
	            socket.connect();
	            socket.on( 'message', function( obj ){
	                message( obj );
       		    } );
	
	            socket.on( 'connection', function( ){ message( {message: ['System', 'Connected']} ); } );
	            socket.on( 'disconnect', function( ){ message( {message: ['System', 'Disconnected']} ); } );
	            socket.on( 'reconnect', function( ){ message( {message: ['System', 'Reconnected to server']} ); } );
	            socket.on( 'reconnecting', function( nextRetry ){ message( {message: ['System', 'Attempting to re-connect to the server. Next retry in ' + nextRetry + 'ms'] } ); } );
	            socket.on( 'reconnect_failed', function( ){ message( {message: ['System', 'Reconnected to server FAILED.'] } ); } );
	        } );
	    </script>
	    <h1>network-graph</h1>
	    <div id="graph" style="width:800px;height:600px;"</div>
	    <div id='messages'></div>
	</body>
</html>
